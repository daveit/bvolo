{"version":3,"file":"/packages/admin.js","sources":["admin/lib/both/AdminDashboard.coffee","admin/lib/both/router.coffee","admin/lib/server/publish.coffee","admin/lib/server/methods.coffee"],"names":[],"mappings":"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","sourcesContent":["AdminDashboard =\n\tschemas: {}\n\talertSuccess: (message)->\n\t\talert 'Success ' + message\n\talertFailure: (message)->\n\t\talert 'Failure ' + message\n\tcheckAdmin: ->\n\t\tif not Roles.userIsInRole Meteor.userId(), ['admin']\n\t\t\tMeteor.call 'adminCheckAdmin'\n\tadminRoutes: ['adminDashboard','adminDashboardUsersNew','adminDashboardUsersView','adminDashboardUsersEdit','adminDashboardView','adminDashboardNew','adminDashboardEdit','adminDashboardDetail']\n\tcollectionLabel: (collection)->\n\t\tif collection == 'Users'\n\t\t\t'Users'\n\t\telse if collection? and typeof AdminConfig.collections[collection].label == 'string'\n\t\t\tAdminConfig.collections[collection].label\n\t\telse Session.get 'admin_collection'\n\n\nAdminDashboard.schemas.newUser = new SimpleSchema\n\temail: \n\t\ttype: String\n\t\tlabel: \"Email address\"\n\tusername:\n\t\ttype: String\n\tchooseOwnPassword:\n\t\ttype: Boolean\n\t\tlabel: 'Let this user choose their own password with an email'\n\t\tdefaultValue: true\n\tpassword:\n\t\ttype: String\n\t\tlabel: 'Password'\n\t\toptional: true\n\tsendPassword:\n\t\ttype: Boolean\n\t\tlabel: 'Send this user their password by email'\n\t\toptional: true\n\nAdminDashboard.schemas.sendResetPasswordEmail = new SimpleSchema\n\t_id:\n\t\ttype: String\n\nAdminDashboard.schemas.changePassword = new SimpleSchema\n\t_id:\n\t\ttype: String\n\tpassword:\n\t\ttype: String\n","Router.map -> \n  @route \"adminDashboard\",\n    path: \"/admin\"\n    template: \"AdminDashboard\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe 'adminUsers',Meteor.subscribe 'adminAllCollections']\n    action: ->\n      Session.set 'admin_title', 'Dashboard'\n      Session.set 'admin_collection', ''\n      Session.set 'admin_collection_page', ''\n      @render()\n    # onBeforeAction: ->\n      # AccountsEntry.signInRequired this\n  @route \"adminDashboardUsersNew\",\n    path: \"/admin/Users/new\"\n    template: \"AdminDashboardUsersNew\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      Meteor.subscribe 'adminUsers'\n    action: -> \n      Session.set 'admin_title', 'Users'\n      Session.set 'admin_subtitle', 'Create new user'\n      Session.set 'admin_collection_page', 'New'\n      Session.set 'admin_collection', 'Users'\n      @render()\n\n  @route \"adminDashboardUsersView\",\n    path: \"/admin/Users/\"\n    template: \"AdminDashboardUsersView\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe 'adminUsers']\n    data: -> { users : Meteor.users.find({},{sort: {createdAt: -1}}).fetch() }\n    action: -> \n      Session.set 'admin_title', 'Users'\n      Session.set 'admin_subtitle', 'View users'\n      Session.set 'admin_collection_page', ''\n      Session.set 'admin_collection', 'Users'\n      @render()\n\n  @route \"adminDashboardUsersEdit\",\n    path: \"/admin/Users/:_id/edit\"\n    template: \"AdminDashboardUsersEdit\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe 'adminUsers']\n    data: ->\n      user : Meteor.users.find({_id:@params._id}).fetch()\n      roles: Roles.getRolesForUser @params._id\n      otherRoles: _.difference _.map( Meteor.roles.find().fetch(), (role)-> role.name), Roles.getRolesForUser(@params._id)\n    action: ->\n      Session.set 'admin_title', 'Users'\n      Session.set 'admin_subtitle', 'Edit user ' + @params._id\n      Session.set 'admin_collection_page', 'edit'\n      Session.set 'admin_collection', 'Users'\n      Session.set 'admin_id', @params._id\n      Session.set 'admin_doc', Meteor.users.findOne({_id:@params._id})\n      @render()\n\n  @route \"adminDashboardView\",\n    path: \"/admin/:collection/\"\n    template: \"AdminDashboardView\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe('adminCollection', @params.collection), Meteor.subscribe('adminAuxCollections', @params.collection), Meteor.subscribe('adminUsers')]\n    data: -> { documents : window[ @params.collection ].find({},{sort: {createdAt: -1}}).fetch() }\n    action: -> \n      Session.set 'admin_title', AdminDashboard.collectionLabel(@params.collection)\n      Session.set 'admin_subtitle', 'View '\n      Session.set 'admin_collection_page', ''\n      Session.set 'admin_collection', @params.collection.charAt(0).toUpperCase() + @params.collection.slice(1)\n      @render()\n    # onBeforeAction: ->\n      # AccountsEntry.signInRequired this\n  @route \"adminDashboardNew\",\n    path: \"/admin/:collection/new\"\n    template: \"AdminDashboardNew\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe('adminAuxCollections', @params.collection), Meteor.subscribe('adminUsers')]\n    action: ->\n      Session.set 'admin_title', AdminDashboard.collectionLabel(@params.collection)\n      Session.set 'admin_subtitle', 'Create new'\n      Session.set 'admin_collection_page', 'new'\n      Session.set 'admin_collection', @params.collection.charAt(0).toUpperCase() + @params.collection.slice(1)\n      @render()\n    # onBeforeAction: ->\n      # AccountsEntry.signInRequired this\n  @route \"adminDashboardEdit\",\n    path: \"/admin/:collection/:_id/edit\"\n    template: \"AdminDashboardEdit\"\n    layoutTemplate: \"AdminLayout\"\n    waitOn: ->\n      [Meteor.subscribe('adminCollection', @params.collection), Meteor.subscribe('adminAuxCollections', @params.collection), Meteor.subscribe('adminUsers')]\n    action: ->\n      Session.set 'admin_title', AdminDashboard.collectionLabel(@params.collection)\n      Session.set 'admin_subtitle', 'Edit ' + @params._id\n      Session.set 'admin_collection_page', 'edit'\n      Session.set 'admin_collection', @params.collection.charAt(0).toUpperCase() + @params.collection.slice(1)\n      Session.set 'admin_id', @params._id\n      Session.set 'admin_doc', window[@params.collection].findOne _id : @params._id\n      @render()\n    # onBeforeAction: ->\n      # AccountsEntry.signInRequired this\n\nRouter.onBeforeAction AdminDashboard.checkAdmin, {only: AdminDashboard.adminRoutes}","Meteor.publish 'adminCollection', (collection) ->\n\tif Roles.userIsInRole this.userId, ['admin']\n\t\tglobal[collection].find()\n\telse\n\t\t@ready()\n\nMeteor.publish 'adminAuxCollections', (collection) ->\n\tif Roles.userIsInRole this.userId, ['admin']\n\t\tif typeof AdminConfig != 'undefined' and typeof AdminConfig.collections[collection].auxCollections == 'object'\n\t\t\tsubscriptions = []\n\t\t\t_.each AdminConfig.collections[collection].auxCollections, (collection)->\n\t\t\t\tsubscriptions.push global[collection].find()\n\t\t\tsubscriptions\n\t\telse\n\t\t\t@ready()\n\telse\n\t\t@ready()\n\nMeteor.publish 'adminAllCollections', ->\n\tif Roles.userIsInRole this.userId, ['admin']\n\t\tif typeof AdminConfig != 'undefined'  and typeof AdminConfig.collections == 'object'\n\t\t\tsubscriptions = []\n\t\t\t_.map AdminConfig.collections, (obj, key)->\n\t\t\t\tsubscriptions.push global[key].find()\n\t\t\tsubscriptions\n\telse\n\t\t@ready()\n\nMeteor.publish 'adminUsers', ->\n\tif Roles.userIsInRole this.userId, ['admin']\n\t\tMeteor.users.find()\n\telse\n\t\t@ready()\n\nMeteor.publish null, ->\n\tMeteor.roles.find({})","Meteor.methods\n\tadminInsertDoc: (doc,collection)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tFuture = Npm.require('fibers/future');\n\t\t\tfut = new Future();\n\n\t\t\tglobal[collection].insert doc, (e,_id)->\n\t\t\t\tfut['return']( {e:e,_id:_id} )\n\t\t\treturn fut.wait()\n\n\tadminUpdateDoc: (modifier,collection,_id)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tFuture = Npm.require('fibers/future');\n\t\t\tfut = new Future();\n\t\t\tglobal[collection].update {_id:_id},modifier,(e,r)->\n\t\t\t\tfut['return']( {e:e,r:r} )\n\t\t\treturn fut.wait()\n\n\tadminRemoveDoc: (collection,_id)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tif collection == 'Users'\n\t\t\t\tMeteor.users.remove {_id:_id}\n\t\t\telse\n\t\t\t\tglobal[collection].remove {_id:_id}\n\n\n\tadminNewUser: (doc) ->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\temails = doc.email.split(',')\n\t\t\t_.each emails, (email)->\n\t\t\t\tuser = {}\n\t\t\t\tuser.email = email\n\t\t\t\tuser.username = doc.username\n\t\t\t\tunless doc.chooseOwnPassword\n\t\t\t\t\tuser.password = doc.password\n\t\t\t\t\t\n\t\t\t\t_id = Accounts.createUser user\n\n\t\t\t\tif doc.sendPassword && typeof AdminConfig.fromEmail != 'undefined'\n\t\t\t\t\tEmail.send(\n\t\t\t\t\t\tto: user.email\n\t\t\t\t\t\tfrom: AdminConfig.fromEmail\n\t\t\t\t\t\tsubject: 'Your accout has been created'\n\t\t\t\t\t\thtml: 'You\\'ve just had an account created for ' + Meteor.absoluteUrl() + ' with password ' + doc.password\n\t\t\t\t\t\t)\n\n\tadminUpdateUser: (modifier,_id)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tFuture = Npm.require('fibers/future');\n\t\t\tfut = new Future();\n\t\t\tMeteor.users.update {_id:_id},modifier,(e,r)->\n\t\t\t\tfut['return']( {e:e,r:r} )\n\t\t\treturn fut.wait()\n\n\tadminSendResetPasswordEmail: (doc)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tconsole.log 'Changing password for user ' + doc._id\n\t\t\tAccounts.sendResetPasswordEmail(doc._id)\n\n\tadminChangePassword: (doc)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tconsole.log 'Changing password for user ' + doc._id\n\t\t\tAccounts.setPassword(doc._id, doc.password)\n\t\t\tlabel: 'Email user their new password'\n\n\tadminCheckAdmin: ->\n\t\tif this.userId and !Roles.userIsInRole this.userId, ['admin']\n\t\t\temail = Meteor.users.findOne(_id:this.userId).emails[0].address\n\t\t\tif typeof AdminConfig != 'undefined' and typeof AdminConfig.adminEmails == 'object'\n\t\t\t\tadminEmails = AdminConfig.adminEmails\n\t\t\t\tif adminEmails.indexOf(email) > -1\n\t\t\t\t\tconsole.log 'Adding admin user: ' + email\n\t\t\t\t\tRoles.addUsersToRoles this.userId, ['admin']\n\t\t\telse if this.userId == Meteor.users.findOne({},{sort:{createdAt:1}})._id\n\t\t\t\tconsole.log 'Making first user admin: ' + email\n\t\t\t\tRoles.addUsersToRoles this.userId, ['admin']\n\n\tadminAddUserToRole: (_id,role)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tRoles.addUsersToRoles _id, role\n\tadminRemoveUserToRole: (_id,role)->\n\t\tif Roles.userIsInRole this.userId, ['admin']\n\t\t\tRoles.removeUsersFromRoles _id, role"]}